# SmartRide Vehicle Booking System

## Overview
SmartRide is a full-stack mobility platform that enables users to request rides, captains to accept them, and both parties to follow live trip progress. The solution combines a Node.js/Express backend, a MongoDB data layer, and a React + Vite frontend with real-time communication over WebSockets.

## Key Features
- **User onboarding** with registration and authentication via JWT.
- **Ride management** covering fare estimation, ride creation, confirmation, and completion.
- **Live tracking** powered by [`LiveTracking`](Frontend/src/components/LiveTracking.jsx) and device GPS.
- **Captain operations** with dashboards and ride acceptance flows.
- **Map services** that leverage Geoapify for geocoding, routing, and autocomplete.
- **Real-time updates** through Socket.IO integration in [Backend/socket.js](Backend/socket.js).

## Architecture
| Layer | Description | Key Modules |
| --- | --- | --- |
| Frontend | React + Vite single-page application styled with TailwindCSS. | [`Home`](Frontend/src/pages/Home.page.jsx), [`CapatainHome`](Frontend/src/pages/captain.home.page.jsx), [`RidingLive`](Frontend/src/pages/Riding.User.page.jsx) |
| Backend | Express REST API with modular controllers and services. | [`user.controller`](Backend/src/Controllers/user.controller.js), [`ride.controller`](Backend/src/Controllers/ride.controller.js), [`maps.service`](Backend/src/services/maps.service.js) |
| Data | MongoDB with Mongoose schemas and indexes. | [`userModel`](Backend/src/Models/user.model.js), [`CaptainModel`](Backend/src/Models/captain.model.js), [`RideModel`](Backend/src/Models/Ride.model.js) |
| Real-time | Socket.IO server broadcasting ride events. | [Backend/socket.js](Backend/socket.js) |

## Prerequisites
- Node.js ≥ 18.x and npm ≥ 9.x
- MongoDB instance (Atlas or self-hosted)
- Geoapify API key for geospatial services

## Environment Configuration
| File | Variables |
| --- | --- |
| `Frontend/.env` | `VITE_BASE_URL`, `VITE_BASE_URL2`, `VITE_GEOAPIFY_API_KEY` |
| `Backend/.env` | `PORT`, `MONGO_URI`, `JWT_SECRET`, `GEOAPIFY_API_KEY` |

Copy the corresponding `.env.sample` files and populate the values before running the apps.

## Getting Started

### Backend
```bash
cd Backend
npm install
npm run dev
```
The API is exposed at `http://localhost:8000`.

### Frontend
```bash
cd Frontend
npm install
npm run dev
```
Open http://localhost:5173 in the browser.

## Project Structure
```
Backend/
  src/
    Controllers/
    Routes/
    Models/
    services/
  socket.js
Frontend/
  src/
    components/
    pages/
    context/
```

## Core Workflows
1. **Authentication**
   - Users register through [`UserSignUp`](Frontend/src/pages/userSignup.page.jsx) and log in via [`UserLogin`](Frontend/src/pages/userLogin.page.jsx); tokens are persisted in localStorage.
   - Captains follow parallel flows in [`CaptainSignUp`](Frontend/src/pages/captainSignup.page.jsx) and [`CaptainLogin`](Frontend/src/pages/captainLogin.page.jsx).

2. **Ride Booking**
   - Users search locations with [`LocationSearchPanel`](Frontend/src/components/LocationPanel.components.jsx), estimate fares through `/api/rides/get-fare`, and create rides using `/api/rides/create`.
   - Captains receive ride offers via Socket.IO events and confirm through `/api/rides/confirm`.

3. **Live Tracking**
   - Device GPS is captured by [`useDeviceLocation`](Frontend/src/components/useDeviceLocation.jsx).
  - [`LiveTracking`](Frontend/src/components/LiveTracking.jsx) renders user/captain paths and updates bounds as coordinates stream in.
  - Socket channels propagate `location-updated`, `ride-confirmed`, and `ride-ended` events.

## API Highlights
| Endpoint | Method | Description |
| --- | --- | --- |
| `/api/users/register` | POST | Register a new user |
| `/api/users/login` | POST | Authenticate and obtain JWT |
| `/api/maps/get-suggestions` | GET | Autocomplete locations |
| `/api/rides/create` | POST | Create a ride request |
| `/api/rides/confirm` | POST | Captain confirms ride |
| `/api/rides/start-ride` | GET | Validate OTP and start ride |
| `/api/rides/end-ride` | POST | Complete ride and finalize fare |

All protected routes expect a bearer token generated by the backend.

## Real-Time Communication
Socket initialization lives in [`SocketProvider`](Frontend/src/context/Socket.context.jsx). Clients join rooms through the `join` event, and the server (see [Backend/socket.js](Backend/socket.js)) stores socket IDs for targeted messaging to riders or captains.

## Code Quality & Tooling
- Linting via `npm run lint` in the frontend (ESLint + React hooks).
- Animations handled by GSAP (`useGSAP`) across various panels.
- TailwindCSS for utility-first styling; see [Frontend/tailwind.config.js](Frontend/tailwind.config.js).

## Deployment Notes
- Ensure environment variables are configured securely on the hosting platform.
- Enable CORS for the frontend origin in production.
- Provide HTTPS for both frontend and backend to guarantee geolocation access in browsers.

## Troubleshooting
| Issue | Resolution |
| --- | --- |
| Map tiles fail to load | Verify `VITE_GEOAPIFY_API_KEY` and domain whitelisting. |
| Logout loops to `/home` | Confirm the token is removed and the backend logout returns 2xx (see [`Home.logout`](Frontend/src/pages/Home.page.jsx)). |
| Location freezes | Check browser location permissions and Socket.IO connectivity logs. |